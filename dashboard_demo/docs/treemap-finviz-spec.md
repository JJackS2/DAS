# Finviz 스타일 트리맵 요구사항 정리

이미지 분석을 바탕으로 **그려야 할 시각화 요소**와 **필요한 인터랙션**을 정리한 문서입니다.

---

## 1. 그려야 할 시각화 요소

### 1.1 트리맵 구조 및 계층

| 계층 | 설명 | DAS 매핑 | 표현 |
|------|------|----------|------|
| **최상위** | 가장 큰 직사각형 영역 | 지역(Region) | 섹터명이 영역 좌측 상단에 크고 굵게 |
| **중간** | 상위 안에 중첩된 영역 | 법인 → 국가 → 제품 L1 → L2 | 하위 섹터명은 더 작은 글씨로 해당 박스 상단/좌측 |
| **최하위** | 가장 작은 박스 | 제품 L3 또는 최종 노드 | 이름 + 비율(%) |

- **박스 크기**: 한 가지 지표(판매/스마트 판매/연결대수)의 규모에 비례.
- **계층 구분**: 중첩 + 레이블 글꼴 크기로 상/하위 구분.

### 1.2 레이블 규칙

| 대상 | 위치 | 스타일 | 내용 |
|------|------|--------|------|
| **섹터(지역)** | 해당 영역 **좌측 상단** | 크고 굵은 글씨, 대비되는 색(예: 흰색) | 지역명 (예: ASIA, AMERICAS) |
| **하위 섹터(법인/국가/제품군)** | 해당 박스 **상단 또는 좌측** | 상위보다 작은 글씨 | 법인명, 국가명, 제품 L1/L2명 |
| **최하위 노드(제품 등)** | 박스 **중앙 또는 상단** | 이름 눈에 띄게 | 노드 이름(예: 제품 L3명) |
| **비율** | 이름 **아래** | 더 작은 글씨, 박스 색과 일치(양수=초록/음수=빨강) | "+9.72%", "-3.2%" 형식 |
| **매우 작은 박스** | — | 공간 부족 시 이름만 또는 생략 | 티커/이름만 또는 텍스트 없음 |

- Finviz: 섹터/하위 섹터는 **흰색** 레이블로 배경(초록/빨강)과 대비.

### 1.3 색상 및 범례

- **색상 의미**
  - **초록**: 양의 지표(상승/높은 비율). 농도 ↑ = 값 ↑
  - **빨강**: 음의 지표(하락/낮은 비율). 농도 ↑ = 절대값 ↑
  - DAS 현재: 연결률/스마트 판매 비율은 0~100% 단일 축 → **한쪽 그라데이션(예: 연한→진한 청록)** 또는 **0% 빨강 ~ 100% 초록** 선택 가능.

- **색상 스케일 범례 (하단)**
  - 트리맵 **가장 하단**에 가로 **그라데이션 막대**.
  - 막대 **아래(또는 옆)** 에 구간 레이블:  
    예: `-10%`, `-6.7%`, `-3.3%`, `0%`, `+3.3%`, `+6.7%`, `+10%`  
    (DAS 비율 0~100%면 `0%`, `25%`, `50%`, `75%`, `100%` 등)

### 1.4 기타 UI (선택)

- **상단 카테고리 바**: 주요 섹터(지역/제품 대분류) 탭으로 클릭 시 해당 영역으로 이동 또는 필터.
- **우측 패널**: 선택한 섹터/노드의 **하위 항목 목록** (이름, 값, 스파크라인, 비율) — 트리맵과 연동.

---

## 2. 필요한 인터랙션

| 인터랙션 | Finviz 동작 | DAS 적용 제안 |
|----------|-------------|----------------|
| **확대/축소** | 마우스 휠로 zoom in/out | `roam: true` 또는 휠 이벤트로 트리맵 zoom |
| **패닝(이동)** | 확대 후 드래그로 지도 이동 | zoom 상태에서 드래그로 pan |
| **클릭(싱글)** | (이미지에서 명시 안 됨) | 노드 클릭 시 zoom to node (현재 `zoomToNode` 유지) |
| **더블클릭** | 티커 더블클릭 → 상세 정보 새 창 | 노드 더블클릭 → 상세 리포트/드릴다운 또는 새 창 |
| **호버(툴팁)** | 호버 시 경쟁사 + 3개월 이력 그래프 | 호버 시 이름, 크기(판매/연결 등), 비율(연결률 등) 툴팁 (현재 구현 유지·보강) |
| **브레드크럼** | (필요 시) 확대 경로 표시 | 현재 breadcrumb 유지 (zoom 후 상위로 돌아가기) |

---

## 3. 현재 구현과의 갭

- **레이블**: `upperLabel`로 계층명 표시함. Finviz처럼 **섹터는 흰색/강조**, **하위는 작은 글씨**로 조정 가능.
- **색상**: 현재 청록 단일 그라데이션. Finviz처럼 **0% 빨강 ~ 100% 초록**으로 바꾸려면 `mapToEcharts` 색상 로직 + 범례 그라데이션 수정.
- **범례**: 하단에 0%~100% 범례 있음. Finviz처럼 **막대 아래에 구간 레이블**(0%, 25%, 50%, 75%, 100%) 추가 가능.
- **인터랙션**: `roam: false` → **휠 zoom + 드래그 pan** 활성화(`roam: true` 또는 'scale'/'move') 검토.
- **우측 패널**: 선택 노드의 하위 목록 패널은 미구현 — 선택 사항.

---

## 4. 구현 우선순위 제안

1. **필수**: 계층별 레이블(상단/좌측) + 하단 색상 범례(구간 레이블 포함).
2. **권장**: 휠 zoom + 드래그 pan (`roam` 활성화).
3. **선택**: 0% 빨강 ~ 100% 초록 색상 체계, 상단 카테고리 바, 우측 상세 목록 패널.
